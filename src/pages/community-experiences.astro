---
import Layout from '../layouts/Layout.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import CommunityStatsDisplay from '../components/CommunityStats';
import CommunityVoting from '../components/CommunityVoting';
import { getCommunityStats } from '../lib/communityData';

// Fetch initial stats server-side
const initialStats = await getCommunityStats();
---

<Layout 
  title="Community Insights - Anonymous Theft Analytics | ProtectMyMobile"
  description="Share your experience anonymously and see real-time analytics on phone theft patterns, recovery rates, and security measures."
>
  <Header />
  
  <main class="bg-[#f3f2f1]">
    <div class="container mx-auto px-4 py-8">
      <div class="max-w-7xl mx-auto">
        
        <!-- Stats Section -->
        <section class="mb-12">
          <CommunityStatsDisplay initialStats={initialStats} client:load />
        </section>
        
        <!-- Voting Section -->
        <section class="mb-12">
          <div class="bg-white rounded-lg shadow-md p-6 md:p-8 mb-6">
            <h2 class="text-2xl font-bold text-neutral-900 mb-3">
              Share Your Experience
            </h2>
            <p class="text-neutral-700 mb-6">
              Help others by anonymously sharing your experience. Answer 6 quick questions to contribute to our community insights. 
              <span class="font-semibold text-primary">No personal information required.</span>
            </p>
            
            <CommunityVoting initialStats={initialStats} client:load />
          </div>
        </section>

        <!-- About This Data -->
        <section class="bg-neutral-50 rounded-lg p-6 border border-neutral-200">
          <h3 class="text-lg font-semibold text-neutral-900 mb-4">
            About This Data
          </h3>
          <div class="grid grid-cols-1 md:grid-cols-3 gap-6 text-sm text-neutral-700">
            <div>
              <h4 class="font-semibold text-neutral-900 mb-2">üîí Privacy First</h4>
              <p>All responses are completely anonymous. We don't collect names, emails, or any personally identifiable information.</p>
            </div>
            <div>
              <h4 class="font-semibold text-neutral-900 mb-2">üìä Real-Time Insights</h4>
              <p>Statistics update automatically as new responses come in, giving you the latest community insights.</p>
            </div>
            <div>
              <h4 class="font-semibold text-neutral-900 mb-2">ü§ù Community Driven</h4>
              <p>This data comes from real people in our community who want to help others understand and prevent phone theft.</p>
            </div>
          </div>
        </section>

      </div>
    </div>
  </main>
  
  <Footer />
</Layout>
