---
import Layout from '../layouts/Layout.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import { MessageSquare } from 'lucide-react';
---

<Layout 
  title="Share Your Experience - Help Others | ProtectMyMobile"
  description="Share your mobile theft experience anonymously to help others in the community learn and prepare."
>
  <Header />
  
  <main class="bg-[#f3f2f1]">
    <div class="container mx-auto px-4 py-8">
      <div class="max-w-3xl mx-auto">
        <h1 class="flex items-center text-3xl font-bold mb-6 flex items-center">
          <MessageSquare class="h-8 w-8 mr-3 text-primary" />
          Share Your Experience
        </h1>
        
        <div class="bg-white rounded-lg shadow-md p-8">
          <p class="text-lg text-neutral-700 mb-6">
            Help others by sharing your experience. Your story can help someone prepare better or respond more effectively.
          </p>
          
          <p class="text-sm text-neutral-600 mb-6">
            All submissions are reviewed before publishing. We may anonymize or edit for clarity and privacy.
          </p>
          
          <!-- Experience Form -->
          <form class="space-y-6" id="experience-form">
            <div>
              <label class="block text-sm font-medium text-neutral-700 mb-3">
                Have you experienced mobile phone theft?
              </label>
              <div class="space-y-2">
                <label class="flex items-center">
                  <input type="radio" name="has_theft" value="yes" required class="mr-2" />
                  <span>Yes, I've had my phone stolen</span>
                </label>
                <label class="flex items-center">
                  <input type="radio" name="has_theft" value="no" class="mr-2" />
                  <span>No, but I want to share prevention tips</span>
                </label>
              </div>
            </div>
            
            <div>
              <label for="when" class="block text-sm font-medium text-neutral-700 mb-2">
                When did this happen?
              </label>
              <input
                type="text"
                id="when"
                name="when"
                required
                class="w-full px-4 py-2 border border-neutral-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary"
                placeholder="e.g., March 2024, Last summer, etc."
              />
            </div>
            
            <div>
              <label for="where" class="block text-sm font-medium text-neutral-700 mb-2">
                Where did this happen?
              </label>
              <input
                type="text"
                id="where"
                name="where"
                required
                class="w-full px-4 py-2 border border-neutral-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary"
                placeholder="e.g., London Underground, Manchester city centre"
              />
            </div>
            
            <div>
              <label for="what_happened" class="block text-sm font-medium text-neutral-700 mb-2">
                What happened? Tell your story
              </label>
              <textarea
                id="what_happened"
                name="what_happened"
                required
                rows="6"
                class="w-full px-4 py-2 border border-neutral-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary"
                placeholder="Share what happened, how you responded, what you learned..."
              ></textarea>
            </div>
            
            <div>
              <label for="doing_differently" class="block text-sm font-medium text-neutral-700 mb-2">
                What would you do differently? (Optional)
              </label>
              <textarea
                id="doing_differently"
                name="doing_differently"
                rows="4"
                class="w-full px-4 py-2 border border-neutral-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary"
                placeholder="Tips and advice for others..."
              ></textarea>
            </div>
            
            <hr class="my-6" />
            
            <div>
              <label for="name" class="block text-sm font-medium text-neutral-700 mb-2">
                Your Name (optional, for attribution)
              </label>
              <input
                type="text"
                id="name"
                name="name"
                class="w-full px-4 py-2 border border-neutral-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary"
                placeholder="Leave blank to remain anonymous"
              />
            </div>
            
            <div>
              <label for="email" class="block text-sm font-medium text-neutral-700 mb-2">
                Your Email (required, not published)
              </label>
              <input
                type="email"
                id="email"
                name="email"
                required
                class="w-full px-4 py-2 border border-neutral-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary"
                placeholder="For verification only, not shown publicly"
              />
              <p class="text-xs text-neutral-500 mt-1">We'll only use this to verify submissions</p>
            </div>
            
            <div>
              <button
                type="submit"
                class="w-full bg-primary text-white py-3 px-6 rounded-md font-medium hover:bg-primary/90 transition-colors"
              >
                Submit Experience
              </button>
            </div>
          </form>
          
          <div id="form-message" class="mt-4 hidden"></div>
        </div>
      </div>
    </div>
  </main>
  
  <Footer />
  
  <script>
    const form = document.getElementById('experience-form') as HTMLFormElement;
    const messageDiv = document.getElementById('form-message');
    
    if (form && messageDiv) {
      form.addEventListener('submit', async (e) => {
        e.preventDefault();
        
        // Show temporary success message
        messageDiv.classList.remove('hidden');
        messageDiv.className = 'mt-4 p-4 bg-green-50 border border-green-200 rounded-md text-green-800';
        messageDiv.textContent = 'Thank you for sharing! Your experience will be reviewed and published soon.';
        
        // Reset form
        form.reset();
        
        // TODO: Implement actual form submission to Supabase experience_reports table
        console.log('Experience submission - implement Supabase integration');
      });
    }
  </script>
</Layout>
